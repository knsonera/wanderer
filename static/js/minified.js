"use strict";function loadUserCategories(t){console.log("categories: sending request"),$.ajax({url:"/api/categories",dataType:"json",success:function(e){console.log("categories received"),e.hasOwnProperty("Categories")&&e.Categories[0]&&t(e.Categories)},error:function(){t([])}})}function loadUserPlaces(e,t){console.log("places: sending request");var l=e.description;$.ajax({url:"/api/places",data:{category:l},success:function(e){console.log("places received"),e.hasOwnProperty("Places")&&e.Places[0]&&t(e.Places)},error:function(){t([])}})}var map,infowindow,ViewModel=function(){var t=this;t.categories=ko.observableArray([]),t.places=ko.observableArray([]),t.selectedCategory=ko.observable({description:"All",id:0,name:"all",user_id:0}),t.currentPlace=ko.observable(),loadUserCategories(function(e){console.log("loading categories"),t.categories(e)}),loadUserPlaces(t.selectedCategory(),function(e){console.log("loading places"),t.places(e)}),t.setCurrentCategory=function(e){console.log("changing current category to "+e.name),t.selectedCategory(e)},t.setCurrentPlace=function(e){t.currentPlace(e)}};_viewModel=new ViewModel,ko.applyBindings(_viewModel);var mapMarkers=[];function initializeMap(){map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:47.62,lng:-122.27},styles:mapStyle,fullscreenControl:!1}),infowindow=new google.maps.InfoWindow({content:"",maxWidth:250});var e=document.createElement("div");new CenterControl(e,map);e.index=1,map.controls[google.maps.ControlPosition.RIGHT_TOP].push(e)}function CenterControl(e,n){var t=document.createElement("div");t.style.backgroundColor="#fff",t.style.border="2px solid #fff",t.style.borderRadius="3px",t.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",t.style.cursor="pointer",t.style.marginTop="10px",t.style.marginRight="13px",t.style.textAlign="center",t.title="Create new point on map (for authenticated users)",e.appendChild(t);var l=document.createElement("div");l.style.color="rgb(25,25,25)",l.style.fontFamily="Roboto,Arial,sans-serif",l.style.fontSize="14px",l.style.lineHeight="25px",l.style.paddingLeft="5px",l.style.paddingRight="5px",l.innerHTML="Add New Point",t.appendChild(l),t.addEventListener("click",function(){document.getElementById("logoutElem")?(n.setOptions({draggableCursor:"copy"}),google.maps.event.addListenerOnce(n,"click",function(e){history.pushState(null,null,"/places/new"),google.maps.event.addListenerOnce(infowindow,"closeclick",function(){history.pushState(null,null,"/")}),n.setOptions({draggableCursor:"auto"});var t=e.latLng.lat(),l=e.latLng.lng(),o=e.latLng,r=document.getElementById("newPlaceForm");infoNewPlaceContentHTML=r.innerHTML,infoNewPlaceContentHTML.className="new-place-visible",infoNewPlaceContent=infoNewPlaceContentHTML,console.log(infoNewPlaceContent),infowindow.setContent(infoNewPlaceContent),infowindow.setPosition(o),infowindow.open(n),document.getElementById("newPlaceLat").value=t,document.getElementById("newPlaceLng").value=l})):document.getElementById("loginElem").click()})}var mapStyle=[{elementType:"geometry",stylers:[{color:"#1d2c4d"}]},{elementType:"labels.text.fill",stylers:[{color:"#8ec3b9"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a3646"}]},{featureType:"administrative",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#64779e"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{color:"#334e87"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#023e58"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#283d6a"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#6f9ba5"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#023e58"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#3C7680"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#304a7d"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#2c6675"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#255763"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b0d5ce"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{color:"#023e58"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"transit",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#283d6a"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#3a4762"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0e1626"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4e6d70"}]}];try{initializeMap()}catch(e){console.log()}